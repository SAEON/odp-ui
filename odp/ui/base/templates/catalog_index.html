{% extends 'base.html' %}
{% from 'catalog.j2' import result_set, filter_panel, filtered_search_proxy %}
{% from 'content.j2' import pagination %}

{% set pagination %}
    {{ pagination(
        query,
        records.page,
        records.pages,
        records.total,
        items_singular='dataset',
        items_plural='datasets'
    ) }}
{% endset %}

{% block main %}
    <main class="flex-grow-1 m-3">
        <div class="container-xl">
            <div class="row">
                <div class="col-3 mx-2">
                    {{ filter_panel(search_form) }}
                </div>
                <div class="col mx-2">
                    {{ filtered_search_proxy(search_form) }}
                    {{ pagination }}
                    {{ result_set(records) }}
                    {% if records.total > 0 %}
                        {{ pagination }}
                    {% endif %}
                </div>
            </div>
        </div>
    </main>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        createFilterMap();
        initFilteredSearchProxy();
    </script>
{% endblock %}
