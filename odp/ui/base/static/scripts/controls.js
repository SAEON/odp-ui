function initHashTabs() {
    /* Create event listeners for synchronising the URL #hash
     * with tabs generated by the `tabs` macro.
     */

    // activate the tab specified in the URL hash, on page load
    $(window).on('load', function () {
        if (location.hash) {
            const tabEl = $(location.hash + '-btn');
            const bsTab = bootstrap.Tab.getOrCreateInstance(tabEl);
            bsTab.show();
        }
    });

    // update the URL hash to match the selected tab, on tab change
    $('button[data-bs-toggle="tab"]').on('shown.bs.tab', function (event) {
        const hash = event.target.id.split('-')[0];
        location.replace('#' + hash);
    });
}

function initCheckAll() {
    $('#check-all').prop('indeterminate', false);

    let checkedAll = false;
    const checkedCount = $('input:checked[id^="check-item-"]').length;

    if (checkedCount > 0) {
        const itemCount = $('input[id^="check-item-"]').length;
        if (checkedCount < itemCount) {
            $('#check-all').prop('indeterminate', true);
        } else {
            checkedAll = true;
        }
    }

    $('#check-all').prop('checked', checkedAll);
    $('label[for="check-all"]').text(`Select ${checkedAll ? 'none' : 'all'}`);
}

function checkAll() {
    const checked = $('#check-all').is(':checked');
    $('input[id^="check-item-"]').prop('checked', checked);
    $('label[for="check-all"]').text(`Select ${checked ? 'none' : 'all'}`);
}

function checkItem() {
    initCheckAll();
}

function flashTooltip(elementId, text) {
    const tooltip = new bootstrap.Tooltip($(`#${elementId}`), {
        title: text,
        trigger: 'manual'
    });
    tooltip.show();
    setTimeout(function () {
        tooltip.hide();
    }, 3000);
}
